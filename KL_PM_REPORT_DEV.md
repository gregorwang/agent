# KL.md 输出问题研发落地拆解（实施版）

## 1. 目标与原则
- 目标：让“借贷问题”的输出以**借贷证据**为主干，避免话题噪声与主体混淆。
- 原则：
  - 证据先于结论
  - 话题约束优于话题扩展
  - 主体归因强制优于弱过滤

## 2. 现状问题拆解（研发视角）
### 2.1 证据偏移
- 现象：输出使用“工资/职业/评价”替代“借贷证据”。
- 影响：结论缺乏支撑，用户不信。
- 根因：召回策略缺少“借贷证据优先级”。

### 2.2 话题污染
- 现象：“历史事件/历史人物/历史典故/微信用途”等进入话题集合。
- 影响：召回范围扩大、噪声增多、精度下降。
- 根因：话题扩展为满足最小数量而补全泛化标签。

### 2.3 主体混淆
- 现象：讨论他人职业的片段被当作目标人物证据。
- 影响：明显逻辑错误，结论被推翻。
- 根因：主体归因不强制，或清洗被跳过。

## 3. 落地方案（按模块拆分）
### 3.1 场景识别与话题白名单
**实现要点**
- 识别“借贷场景”后，仅允许话题来自白名单。
- 白名单建议：`借贷/还款/欠款/信用/工资/收入/消费习惯/评价`。

**验收标准**
- 不再出现“历史事件/历史人物/历史典故/微信用途”等噪声话题。

### 3.2 证据优先级排序
**实现要点**
- 对证据打分：借贷直接证据 > 还款/逾期 > 资金压力 > 职业/工资/评价。
- 若无直接证据，输出“证据不足”并缩减结论强度。

**验收标准**
- 借贷问题输出中，首屏必须包含借贷证据或“证据不足”提示。

### 3.3 主体归因强制
**实现要点**
- 对包含“职业/工资/评价”的片段做强制主体归因。
- 若 facts 显示主体为他人，则整窗剔除。

**验收标准**
- “他人职业/评价”片段不再进入最终输出。

### 3.4 透明日志与可解释性
**实现要点**
- 输出日志包含：语义命中数、过滤数、过滤示例。
- 让产品能解释“匹配数/加载数/输出数”的关系。

**验收标准**
- 日志中可直接定位检索路径与过滤原因。

## 4. 测试用例拆解
### 4.1 正例
输入：明确借钱、还款、欠款相关对话  
预期：输出直接呈现借贷证据，结论与证据一致。

### 4.2 反例
输入：仅有工资/职业对话，缺乏借贷行为  
预期：提示“证据不足”，不做强结论。

### 4.3 主体混淆用例
输入：对话中提及他人职业  
预期：该窗口剔除或明确标注主体非目标人物。

## 5. 执行顺序建议（研发排期）
1) 话题白名单  
2) 主体归因强制  
3) 借贷证据优先级  
4) 透明日志增强  

## 6. 流程图（研发落地版）
```text
用户问题
  ↓
场景识别（借贷）
  ↓
话题白名单过滤
  ↓
话题索引召回 + 语义召回
  ↓
主体归因过滤（剔除他人证据）
  ↓
证据分层排序（借贷证据优先）
  ↓
输出：证据清单 + 结论（无证据则提示不足）
```
